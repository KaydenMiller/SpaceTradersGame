@using SpaceTraders.Core
@inject ShipApiService ShipApiService

<MudStack Row>
    <MudSlider @ref="QuantitySlider" Min="1" Max="Item.Quantity"/>
    <MudText Typo="Typo.body2">@QuantitySlider.Value</MudText>
    <MudButton Color="Color.Warning"
               Variant="Variant.Filled"
               OnClick="@(() => SellInventoryItem(Item.Id, QuantitySlider?.Value ?? 0))">Sell</MudButton>
</MudStack>

@code {

    [Parameter]
    public Ship ActiveShip { get; set; } = default!;

    [Parameter]
    public InventoryItem Item { get; set; } = default!;

    public MudSlider<int>? QuantitySlider { get; set; }
    
    private async Task SellInventoryItem(string itemId, int quantityToSell)
    {
        if (ActiveShip is null) throw new NullReferenceException("CurrentShip cannot be null in order to sell");
        
        _ = await ShipApiService.SellCargo(ActiveShip, itemId, quantityToSell);
    } 
}